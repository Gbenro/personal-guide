# Story 1.1: Implement Mood and Energy Tracking

## Status
Draft

## Story
**As a** Personal Guide user,
**I want** to track my mood and energy levels throughout the day,
**so that** I can identify patterns, understand what affects my well-being, and make informed decisions about my daily habits.

## Acceptance Criteria
1. User can record mood rating (1-10 scale) with intuitive interface
2. User can record energy level (1-10 scale) with visual indicators
3. User can add optional notes and context to mood/energy entries
4. User can view mood and energy trends over time (7-day, 30-day views)
5. System provides insights and patterns from mood/energy data
6. Mood/energy data integrates with existing habit tracking system
7. Data persists across sessions and is accessible from dashboard

## Tasks / Subtasks
- [ ] Task 1: Enhance MoodEnergyTracker component integration (AC: 1, 2, 3)
  - [ ] Review existing MoodEnergyTracker.tsx component
  - [ ] Ensure proper state management integration with personalGuideStore
  - [ ] Implement proper data submission to backend
  - [ ] Add error handling and loading states
- [ ] Task 2: Implement data persistence layer (AC: 6, 7)
  - [ ] Create mood/energy data models and types
  - [ ] Implement API endpoints for CRUD operations
  - [ ] Add database schema for mood/energy entries
  - [ ] Integrate with Supabase backend
- [ ] Task 3: Build analytics and insights features (AC: 4, 5)
  - [ ] Create mood/energy trend calculation functions
  - [ ] Implement data visualization components
  - [ ] Add pattern recognition for insights
  - [ ] Create dashboard integration for trend display
- [ ] Task 4: Testing and validation (All ACs)
  - [ ] Write unit tests for MoodEnergyTracker component
  - [ ] Write integration tests for data persistence
  - [ ] Write tests for analytics functions
  - [ ] Add validation tests for data integrity

## Dev Notes

### Previous Story Insights
This is the first story in the epic, no previous story context available.

### Data Models
Based on existing implementation in personalGuideStore.ts:
```typescript
interface MoodEnergyEntry {
  id: string
  userId: string
  timestamp: Date
  moodRating: number // 1-10 scale
  energyLevel: number // 1-10 scale
  notes?: string
  tags?: string[]
  context?: {
    weather?: string
    location?: string
    activities?: string[]
    stressLevel?: number
  }
}
```
[Source: personalGuideStore.ts analysis]

### API Specifications
Current store interface indicates these methods need backend implementation:
- `addMoodEnergyEntry(entry: MoodEnergyEntry)` - POST /api/mood-energy
- `setMoodEnergyEntries(entries: MoodEnergyEntry[])` - GET /api/mood-energy
- `getMoodEnergyStats()` - GET /api/mood-energy/stats

[Source: personalGuideStore.ts lines 150-157]

### Component Specifications
Existing components ready for integration:
- `MoodEnergyTracker` at `/src/components/mood/MoodEnergyTracker.tsx`
- `QuickMoodTracker` at `/src/components/journal/QuickMoodTracker.tsx`
- Already imported in DashboardTab.tsx for display

[Source: source-tree.md and existing codebase analysis]

### File Locations
Based on project structure:
- Components: `/src/components/mood/`
- API routes: `/src/app/api/mood-energy/`
- Types: `/src/types/mood.ts`
- Stores: `/src/stores/personalGuideStore.ts` (already exists)
- Tests: `/src/components/mood/__tests__/`

[Source: source-tree.md]

### Testing Requirements
Per coding standards:
- Unit tests for all business logic using Vitest
- Integration tests for key workflows
- TypeScript strict mode compliance
- Error boundaries for React components

[Source: coding-standards.md]

### Technical Constraints
- React 18+ with TypeScript
- Tailwind CSS for styling
- React Query for data fetching (not yet implemented in this story)
- PostgreSQL for data persistence via Supabase

[Source: tech-stack.md]

## Testing
### Testing Standards from Architecture
- **Test file location:** `src/components/mood/__tests__/MoodEnergyTracker.test.tsx`
- **Test standards:** Unit tests for all business logic, meaningful test names
- **Testing frameworks:** Vitest for unit tests, React Testing Library for component tests
- **Specific requirements:** Test mood/energy submission, data validation, error handling, and trend calculations

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-09-18 | 1.0 | Initial story creation | Bob (SM) |

## Dev Agent Record
*This section will be populated by the development agent during implementation*

### Agent Model Used
*To be filled by dev agent*

### Debug Log References
*To be filled by dev agent*

### Completion Notes List
*To be filled by dev agent*

### File List
*To be filled by dev agent*

## QA Results
*Results from QA Agent review will be added here after implementation*